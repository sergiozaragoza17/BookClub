{% extends 'base.html.twig' %}

{% block title %}My Profile{% endblock %}

{% block body %}
    <h1 class="mt-3 text-center">My Profile</h1>
    <div class="container mt-3 p-4 ">
        <div class="card shadow-sm p-4">
            <div class="text-center mb-4">
                <img src="{{ user.profileImage }}" alt="{{ user.name }}" class="rounded-circle img-thumbnail" style="width: 150px; height: 150px; object-fit: cover;">
            </div>

            <div class="row mb-2">
                <div class="col-sm-4 fw-bold ">Email:</div>
                <div class="col-sm-8 ">{{ user.email }}</div>
            </div>
            <div class="row mb-2">
                <div class="col-sm-4 fw-bold">Name:</div>
                <div class="col-sm-8">{{ user.name }}</div>
            </div>
            <div class="row mb-2">
                <div class="col-sm-4 fw-bold">Username:</div>
                <div class="col-sm-8">{{ user.userName }}</div>
            </div>
            <div class="row mb-2">
                <div class="col-sm-4 fw-bold">Bio:</div>
                <div class="col-sm-8">{{ user.bio ?: 'Not set' }}</div>
            </div>
            {% if 'ROLE_ADMIN' not in user.roles %}
            <div class="row mb-2">
                <div class="col-sm-4 fw-bold">Favorite Book:</div>
                <div class="col-sm-8">{{ user.favBook ? user.favBook.title : 'Not set' }}</div>
            </div>
            <div class="row mb-2">
                <div class="col-sm-4 fw-bold">Currently Reading:</div>
                <div class="col-sm-8">{{ user.currentlyReading ? user.currentlyReading.title : 'Not set' }}</div>
            </div>
            <div class="row mb-2">
                <div class="col-sm-4 fw-bold">Favorite Genres:</div>
                <div class="col-sm-8">{{ user.favGenres|join(', ') ?: 'Not set' }}</div>
            </div>
            <div class="row mb-2">
                <div class="col-sm-4 fw-bold">Joined At:</div>
                <div class="col-sm-8">{{ user.joinedAt|date('Y-m-d') }}</div>
            </div>
            <div class="row mb-2">
                <div class="col-sm-4 fw-bold">Total Reviews Written:</div>
                <div class="col-sm-8">{{ totalReviews }}</div>
            </div>
{% endif %}
        </div>
    </div>
    <div class="container mb-3 d-flex justify-content-between align-items-center mt-3">
        <div>
            <a href="{{ path('profile_edit', {'id':  user.id}) }}" class="btn btn-primary">Edit Profile</a>
            <a href="{{ path('profile_change_password') }}" class="btn btn-secondary">Change Password</a>
        </div>
        <form action="{{ path('profile_delete') }}" method="post" style="display: inline;">
            <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ user.id) }}">
            <button class="btn btn-danger" type="submit">Delete Account</button>
        </form>
    </div>
{% endblock %}